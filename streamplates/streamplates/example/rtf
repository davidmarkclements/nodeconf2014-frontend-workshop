<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Source file</title>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body class="hl">
<pre class="hl"><span class="hl kwa">var</span> request <span class="hl opt">=</span> <span class="hl kwd">require</span><span class="hl opt">(</span><span class="hl str">'hyperquest'</span><span class="hl opt">);</span>
<span class="hl kwa">var</span> JSONStream <span class="hl opt">=</span> <span class="hl kwd">require</span><span class="hl opt">(</span><span class="hl str">'JSONStream'</span><span class="hl opt">);</span>
<span class="hl kwa">var</span> streamplates <span class="hl opt">=</span> <span class="hl kwd">require</span><span class="hl opt">(</span><span class="hl str">'../..'</span><span class="hl opt">);</span>
<span class="hl kwa">var</span> fs <span class="hl opt">=</span> <span class="hl kwd">require</span><span class="hl opt">(</span><span class="hl str">'fs'</span><span class="hl opt">);</span>

<span class="hl kwa">var</span> tmpl <span class="hl opt">=</span> streamplates<span class="hl opt">.</span><span class="hl kwd">partial</span><span class="hl opt">(</span>fs<span class="hl opt">.</span><span class="hl kwd">readFileSync</span><span class="hl opt">(</span><span class="hl str">'./partial.tmpl'</span><span class="hl opt">));</span>

<span class="hl kwa">var</span> parse <span class="hl opt">=</span> JSONStream<span class="hl opt">.</span><span class="hl kwd">parse</span><span class="hl opt">(</span><span class="hl str">'rows.*.doc'</span><span class="hl opt">,</span> <span class="hl kwa">function</span> <span class="hl opt">(</span>doc<span class="hl opt">) {</span> 
  	<span class="hl kwa">return</span> <span class="hl opt">{</span>
  	  name<span class="hl opt">:</span> doc<span class="hl opt">.</span>name <span class="hl opt">||</span> <span class="hl str">''</span><span class="hl opt">,</span>
  	  description<span class="hl opt">:</span> doc<span class="hl opt">.</span>description <span class="hl opt">?</span> doc<span class="hl opt">.</span>description <span class="hl opt">||</span> <span class="hl str">''</span> <span class="hl opt">:</span> <span class="hl str">''</span><span class="hl opt">,</span>
  	  author<span class="hl opt">:</span> doc<span class="hl opt">.</span>author <span class="hl opt">?</span> doc<span class="hl opt">.</span>author<span class="hl opt">.</span>name <span class="hl opt">||</span> <span class="hl str">''</span> <span class="hl opt">:</span> <span class="hl str">''</span><span class="hl opt">,</span>
  	  url<span class="hl opt">:</span> doc<span class="hl opt">.</span>repository <span class="hl opt">?</span> doc<span class="hl opt">.</span>repository<span class="hl opt">.</span>url <span class="hl opt">||</span> <span class="hl str">''</span> <span class="hl opt">:</span> <span class="hl str">''</span>
  	<span class="hl opt">}</span>
  <span class="hl opt">})</span>


<span class="hl kwd">request</span><span class="hl opt">(</span><span class="hl str">'https://skimdb.npmjs.com/registry/_all_docs?include_docs=true'</span><span class="hl opt">)</span>
  <span class="hl opt">.</span><span class="hl kwd">pipe</span><span class="hl opt">(</span>parse<span class="hl opt">)</span>
  <span class="hl opt">.</span><span class="hl kwd">pipe</span><span class="hl opt">(</span>tmpl<span class="hl opt">)</span>
  <span class="hl opt">.</span><span class="hl kwd">pipe</span><span class="hl opt">(</span>process<span class="hl opt">.</span>stdout<span class="hl opt">)</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 3.14, http://www.andre-simon.de/-->
